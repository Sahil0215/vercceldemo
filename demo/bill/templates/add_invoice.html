<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Form</title>
</head>
<body>
    <h1>Generate Invoice</h1>
    <form method="post">
        {% csrf_token %}
        
        
        <label>From:</label>
        <select name="invoice_from" onchange="checkAddOption(this)">
            {% for s in sellers %}
            <option value="{{ s.id }}">{{ s.name}}</option>
            {% endfor %}
            <option value="add_seller">Add Seller</option>
        </select>
        <br>
        
        
        
        <label>To:</label>
        <select name="invoice_to" onchange="checkAddOption(this)">
            {% for b in buyers %}
            <option value="{{ b.id }}">{{ b.name}}</option>
            {% endfor %}
            <option value="add_buyer">Add Buyer</option>
        </select>
        <br>

        <label>Date: </label>
        <input type="date" name="date"><br>

        
        <label>E-Way Bill No. (if any):  </label>
        <input type="text" name="eway"><br>
        

        <label>Transport :  </label>
        <input type="text" name="transport"><br>
        

        <label>Vehicle No :  </label>
        <input type="text" name="vehicle_no"><br>
        
        
        <label>Number Of Items to be Billed :  </label>
        <input type="number" name="no_of_items"><br>

        <div id="items_container"></div><br>
        


        <label>Other Charges:  </label>
        <input type="number" name="other_charges"><br>

        
        <label>Discount:  </label>
        <input type="number" name="discount"><br>

    
        
        <button type="submit">Generate Bill</button>
    </form>

    <script>
        function toggleReceiver() {
            const receiverCheckbox = document.getElementById('receiver_same_as_buyer');
            const receiverDiv = document.getElementById('receiver_div');
            receiverDiv.style.display = receiverCheckbox.checked ? 'none' : 'block';
        }

        function showItemBlocks() {
            const numItems = document.getElementById('no_of_items').value;
            const itemsContainer = document.getElementById('items_container');
            itemsContainer.innerHTML = '';

            for (let i = 1; i <= numItems; i++) {
                const itemDiv = document.createElement('div');
                itemDiv.innerHTML = `
                    <h3>Item ${i}</h3>
                    <label for="item_name">Item Name:</label>
                    <select id="item_name" name="item_name" onchange="checkAddOption(this)">
                        {% for i in items %}
                        <option value="{{ i.name }}">{{ i.name }}</option>
                        {% endfor %}
                        <option value="add_item">Add Item</option>
                    </select><br><br>

                    <label for="rate_${i}">Rate:</label>
                    <input type="number" id="rate_${i}" name="rate_${i}" required><br><br>

                    <label for="unit_${i}">Unit:</label>
                    <select id="unit_${i}" name="unit_${i}">
                        <option value="kg">kg</option>
                        <option value="litre">litre</option>
                        <option value="piece">piece</option>
                    </select><br><br>

                    <label for="quantity_${i}">Quantity:</label>
                    <input type="number" id="quantity_${i}" name="quantity_${i}" required><br><br>
                `;
                itemsContainer.appendChild(itemDiv);
            }
        }

        function checkAddOption(selectElement) {
            if (selectElement.value === "add_seller") {
                window.location.href = "/add_seller/";
            } else if (selectElement.value === "add_buyer") {
                window.location.href = "/add_buyer/";
            } else if (selectElement.value === "add_item") {
                window.location.href = "/add_item/";
            }
        }
    </script>
</body>
</html>
